<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
    <link rel="stylesheet" href="./lib/leaflet-measure.css">
    <link rel="stylesheet" href="./lib/MarkerCluster.css">
    <link rel="stylesheet" href="./lib/MarkerCluster.Default.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.css" />

    <title>Leaflet Geoproject</title>
    <style>
        #map {
            width: 100%;
            height: 700px;
        }
    </style>

</head>

<body>
    <div id="map"></div>
    <button onclick=fullScreenView()>View in full screen</button>
    <div class="coordinate"></div>
    <button class="print-map">Print map</button>
    <button class="zoom-to-layer">Zoom to layer</button>
</body>

</html>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
<script src="./lib/leaflet.browser.print.min.js"></script>
<script src="./lib/leaflet-measure.js"></script>
<script src="./data/test.js"></script>
<script src="./lib/leaflet.markercluster.js"></script>
<script src="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js"></script>
<script>
    // map class initialize
    var map = L.map('map', {
        center: [-23.5489, -46.6388],
        zoom: 10,
        mmeasureControl: true
    });
    map.zoomControl.setPosition('topright');

    // adding osm tilelayer
    var osm = L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(map);

    var stad = L.tileLayer('https://tiles.stadiamaps.com/tiles/stamen_terrain/{z}/{x}/{y}{r}.{ext}', {
        minZoom: 0,
        maxZoom: 18,
        attribution: '&copy; <a href="https://www.stadiamaps.com/" target="_blank">Stadia Maps</a> &copy; <a href="https://www.stamen.com/" target="_blank">Stamen Design</a> &copy; <a href="https://openmaptiles.org/" target="_blank">OpenMapTiles</a> &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
        ext: 'png'
    });
    // adding osm marker
    var singleMarker = L.marker([-23.5489, -46.6388])
        .bindPopup('A pretty CSS popup.<br> Easily customizable.')
        .openPopup();

    //add map scale
    L.control.scale().addTo(map);

    //Full screen map view
    var mapId = document.getElementById('map');
    function fullScreenView() {
        event.preventDefault();
        mapId.requestFullscreen();
    }

    //Map coordinate display
    map.on('mousemove', function (e) {
        console.log(e)
        $('.coordinate').html(`Lat: ${e.latlng.lat} Lng: ${e.latlng.lng}`)
    })

    // Map print
    $(`.print-map`).click(function () {
        window.print();
    });

    // Leaflet browser print function
    L.control.browserPrint().addTo(map);

    // Leaflet meadure function
    L.control.measure().addTo(map);

    // Geojson load
    var marker = L.markerClusterGroup();
    var sampa = L.geoJSON(data, {
        onEachFeature: function (feature, layer) {
            layer.bindPopup(feature.properties.name);
        }
    });
    sampa.addTo(marker);
    //marker.addTo(map);

    //Leaflet geocoder
    L.Control.geocoder().addTo(map);

    // Leaflet layer control
    var baseMaps = {
        "OSM": osm,
        "Stadia": stad
    }

    var overlayerMaps = {
        'GeoJSON Markers': marker,
        'Single Marker': singleMarker,
    }

    L.control.layers(baseMaps, overlayerMaps).addTo(map);

    // Zoom to layer
    $('.zoom-to-layer').click(function () {
        map.setView([-23.5489, -46.6388], 10)
    })
</script>